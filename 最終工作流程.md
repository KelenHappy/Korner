# 最終工作流程 - 完整測試指南

## 工作流程概述

```
┌─────────────────────────────────────────────────────────────┐
│ 1. 初始狀態：小人在屏幕上（可拖曳）                           │
└─────────────────────────────────────────────────────────────┘
                            ↓
┌─────────────────────────────────────────────────────────────┐
│ 2. 點擊 📸 按鈕：進入全屏截圖模式                            │
│    (小人暫時消失)                                            │
└─────────────────────────────────────────────────────────────┘
                            ↓
┌─────────────────────────────────────────────────────────────┐
│ 3. 選擇截圖區域並完成                                       │
└─────────────────────────────────────────────────────────────┘
                            ↓
┌─────────────────────────────────────────────────────────────┐
│ 4. 小人回來 + QueryWindow 彈出                               │
│    (中間有彈入動畫)                                         │
│    - 顯示截圖預覽                                           │
│    - 輸入框(焦點已激活)                                     │
│    - 快速提示按鈕                                           │
│    - 半透明遮罩背景                                         │
└─────────────────────────────────────────────────────────────┘
                            ↓
┌─────────────────────────────────────────────────────────────┐
│ 5. 用戶輸入問題                                              │
│    - 可直接輸入文字                                         │
│    - 可點擊快速提示按鈕自動填入                             │
│    - 按 Ctrl+Enter (或 Cmd+Enter) 提交                      │
└─────────────────────────────────────────────────────────────┘
                            ↓
┌─────────────────────────────────────────────────────────────┐
│ 6. 提交問題                                                  │
│    - QueryWindow 立即關閉                                   │
│    - 小人回到視圖                                           │
│    - Chatbox 自動彈出（在小人右側）                         │
│    - 顯示加載動畫(三個跳動的點)                             │
└─────────────────────────────────────────────────────────────┘
                            ↓
┌─────────────────────────────────────────────────────────────┐
│ 7. 收到 AI 回應                                              │
│    - Chatbox 顯示 AI 的文字回應                             │
│    - 可拖動 chatbox 標題欄移動位置                          │
│    - 可拖動小人到任何位置                                   │
│    - 內容可滾動查看                                         │
└─────────────────────────────────────────────────────────────┘
```

## 詳細測試步驟

### 步驟 1：啟動應用
```bash
.\build\bin\Korner.exe
```

**預期結果：**
- ✅ 應用窗口打開（透明或半透明背景）
- ✅ 看到紫色漸變的圓形小人（桌寵）
- ✅ 小人左下有 ☰ 選單按鈕
- ✅ 小人右下有 📸 截圖按鈕
- ✅ 小人有浮動動畫（上下輕微移動）

### 步驟 2：測試拖曳小人
1. 用滑鼠按住小人圓形區域
2. 拖曳到屏幕不同位置（上下左右）
3. 嘗試拖到屏幕邊角

**預期結果：**
- ✅ 小人跟隨滑鼠移動
- ✅ 滑鼠游標顯示為 "grab" 或 "grabbing"
- ✅ 小人不會超出窗口邊界
- ✅ 拖動流暢無卡頓

### 步驟 3：測試截圖流程
1. 點擊小人右下的 📸 按鈕
2. **驗證：** 屏幕進入全屏截圖模式
   - ✅ 小人消失
   - ✅ 屏幕變暗/出現截圖工具
   - ✅ 可以看到截圖選擇框
3. 用滑鼠拖曳選擇要截圖的區域
4. 放開滑鼠完成截圖

**預期結果：**
- ✅ 截圖模式退出
- ✅ 小人立刻回到原位置或最後拖動的位置
- ✅ QueryWindow 彈出（中央有半透明遮罩）
- ✅ QueryWindow 中顯示剛才截取的截圖預覽

### 步驟 4：測試 QueryWindow UI
**驗證 QueryWindow 的各個元素：**

**頂部（紫色漸變標題欄）：**
- ✅ 標題文字：💭 Ask about this screenshot
- ✅ 右上角 ✕ 按鈕可以關閉窗口

**中間內容區：**
- ✅ 截圖預覽（可以看到剛才截的圖）
- ✅ "Your Question" 標籤
- ✅ 文字輸入框（焦點已激活，可直接輸入）
- ✅ 字數統計："0 / 1000"
- ✅ 快捷鍵提示："Press Ctrl+Enter to submit"（或 Cmd+Enter）
- ✅ 快速提示按鈕 6 個（排成 2 列 3 行）

**底部（淡灰色背景）：**
- ✅ "Cancel" 按鈕（灰色）
- ✅ "✨ Ask AI" 按鈕（紫色漸變，初始時可用）

### 步驟 5：測試輸入問題

#### 方式 1：直接輸入
1. QueryWindow 開啟後直接輸入問題，例如：
   - "這是什麼？"
   - "Explain this code"
   - 混合中英文輸入
2. **驗證：**
   - ✅ 文字正常輸入
   - ✅ 字數統計實時更新
   - ✅ "Ask AI" 按鈕保持可用

#### 方式 2：使用快速提示
1. 點擊快速提示按鈕之一，例如 "Explain this"
2. **驗證：**
   - ✅ 輸入框自動填入該文字
   - ✅ 字數統計更新
   - ✅ 可以修改或直接提交

#### 方式 3：鍵盤快捷鍵
1. 輸入問題後，按 **Ctrl+Enter**（Windows）或 **Cmd+Enter**（Mac）
2. **驗證：**
   - ✅ 問題立即提交
   - ✅ QueryWindow 關閉

### 步驟 6：提交問題

1. 在 QueryWindow 中輸入問題
2. 點擊 "✨ Ask AI" 按鈕（或按 Ctrl+Enter）

**預期結果：**
- ✅ QueryWindow 立即關閉
- ✅ 小人立即顯示在視圖中
- ✅ 如果之前移動過小人，應該還在移動後的位置
- ✅ Chatbox 自動在小人右側彈出

### 步驟 7：查看加載狀態

提交問題後，Chatbox 應該顯示：
- ✅ 標題欄："💬 Response"
- ✅ 三個跳動的點動畫（●●●）
- ✅ "Thinking..." 文字
- ✅ 標題欄右上角有 ✕ 關閉按鈕

**驗證動畫：**
- ✅ 三個點應該有跳動/脈衝動畫
- ✅ 加載狀態持續（等待 API 回應）

### 步驟 8：查看 AI 回應

等待 API 回應（或開發模式下的模擬回應）：

**預期結果：**
- ✅ Chatbox 中的加載動畫消失
- ✅ 顯示 AI 的文字回應
- ✅ 文字能正常換行顯示
- ✅ 如果內容很長，可以在 Chatbox 內滾動

### 步驟 9：測試 Chatbox 拖動

Chatbox 顯示後：
1. 按住 Chatbox 的紫色標題欄
2. 拖動到屏幕不同位置

**預期結果：**
- ✅ Chatbox 可以獨立拖動
- ✅ 小人位置不變
- ✅ Chatbox 不會超出窗口邊界

### 步驟 10：測試同時移動小人和 Chatbox

1. 拖動小人到屏幕左邊
2. 拖動 Chatbox 到屏幕右邊
3. 再拖動小人回到中間

**預期結果：**
- ✅ 小人和 Chatbox 完全獨立移動
- ✅ 沒有互相干擾

### 步驟 11：測試第二次截圖

1. 再次點擊小人的 📸 按鈕
2. 選擇一個新的截圖區域
3. 輸入新的問題
4. 提交

**預期結果：**
- ✅ 完整流程重複進行
- ✅ 新的截圖預覽顯示在 QueryWindow 中
- ✅ 新的回應替換掉舊的 Chatbox 內容

### 步驟 12：測試選單功能

1. 點擊小人左下的 ☰ 按鈕
2. 應該彈出選單，包含：
   - 📸 Screenshot
   - 💬